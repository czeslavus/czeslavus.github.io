function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{Fu6J:function(e,t,n){"use strict";n.r(t),n.d(t,"LockerPageModule",(function(){return M}));var i,c,o,r,a=n("TEn/"),b=n("ofXK"),s=n("3Pt+"),u=n("qtYk"),l=n("tyNb"),h=n("fXoL"),f=n("WcP9"),v=n("5+tZ"),d=n("vkgz"),g=n("lJxs"),p=n("cp0P"),y=((i=function(){function e(t){_classCallCheck(this,e),this.ble=t}return _createClass(e,[{key:"config",value:function(e){this._config=e}},{key:"connectDevice",value:function(){var e=this;return this.ble.discover$({acceptAllDevices:!0,optionalServices:[this._config.service,this._config.openService]}).pipe(Object(v.a)((function(t){return e.gatt=t,Object(p.a)({battery:e.ble.getPrimaryService$(t,e._config.service),open:e.ble.getPrimaryService$(t,e._config.openService)})})),Object(d.a)((function(t){e.batteryService=t.battery,e.openService=t.open,console.log("mamy to!")})))}},{key:"subscribeToRead",value:function(){var e=this;return this.ble.getCharacteristic$(this.batteryService,this._config.characteristic).pipe(Object(v.a)((function(t){return e.ble.observeValue$(t)})),Object(g.a)((function(e){return e.getUint8(0)})))}},{key:"changeState",value:function(e){var t=this,n=new TextEncoder,i=n.encode("open");return e||(i=n.encode("close")),this.ble.getCharacteristic$(this.openService,this._config.openCharacteristic).pipe(Object(g.a)((function(e){return t.ble.writeValue$(e,i)})))}},{key:"getDevice",value:function(){return this.ble.getDevice$()}},{key:"stream",value:function(){return this.ble.streamValues$().pipe(Object(g.a)(this._config.decoder))}},{key:"value",value:function(){return this.ble.value$({service:this._config.service,characteristic:this._config.characteristic})}},{key:"testRead",value:function(){var e=this;return this.ble.discover$({acceptAllDevices:!0,optionalServices:[this._config.service]}).pipe(Object(v.a)((function(t){return console.log("Pobieram serwis ... ",t),e.ble.getPrimaryService$(t,e._config.service)})),Object(v.a)((function(t){return console.log("Pobieram dost\u0119p do baterii .... ",t),e.ble.getCharacteristic$(t,e._config.characteristic)})),Object(v.a)((function(t){return console.log("Czytam warto\u015bci ...",t),e.ble.observeValue$(t)})),Object(g.a)((function(e){return e.getUint8(0)})))}},{key:"disconnectDevice",value:function(){this.ble.disconnectDevice()}}]),e}()).\u0275fac=function(e){return new(e||i)(h.Pb(f.a))},i.\u0275prov=h.Fb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),k=[{path:"",component:(c=function(){function e(t,n){_classCallCheck(this,e),this.ble=t,this.bleService=n,this.currentValue=0,this.hasErrorVisible=!1,n.config({decoder:function(e){return e.getInt8(0)},service:"6a4e8bba-a22a-4549-89c8-8eb06c4e6dae",openService:"f72860b3-dfeb-4c98-b2f7-e61276e585dd",characteristic:"ef7eb858-9415-4ac1-82d7-4d9eda7ac01e",openCharacteristic:"digital"})}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.getDeviceStatus(),this.streamSubscription=this.bleService.stream().subscribe((function(){return e.updateValue.bind(e)}),(function(t){return e.hasError.bind(e)}))}},{key:"ngOnDestroy",value:function(){this.valuesSubscription.unsubscribe(),this.deviceSubscription.unsubscribe(),this.streamSubscription.unsubscribe()}},{key:"connectBluetooth",value:function(){this.bleService.connectDevice().subscribe(console.log,this.hasError.bind(this))}},{key:"getDeviceStatus",value:function(){this.deviceSubscription=this.bleService.getDevice().subscribe((function(e){e?console.log("Jest device",e):console.log("nie ma device")}),this.hasError.bind(this))}},{key:"disconnectBluetooth",value:function(){this.bleService.disconnectDevice()}},{key:"startRead",value:function(){var e=this;this.bleService.subscribeToRead().subscribe((function(t){e.currentTS=new Date,e.currentValue=t}),this.hasError.bind(this))}},{key:"changeState",value:function(e){console.log("Zmieniam stan na ",e),this.bleService.changeState(e).subscribe(console.log,this.hasError.bind(this))}},{key:"readBattery",value:function(){var e=this;this.bleService.value().subscribe((function(t){e.currentTS=new Date,e.currentValue=t.getInt8(0)}),this.hasError.bind(this))}},{key:"updateValue",value:function(e){this.currentTS=new Date,this.currentValue=e}},{key:"runBluetooth",value:function(){var e=this;this.bleService.testRead().subscribe((function(t){e.currentTS=new Date,e.currentValue=t}))}},{key:"runByPromises",value:function(){var e=window.navigator;e.bluetooth?e.bluetooth.requestDevice({filters:[{services:["automation_io"]}]}).then((function(e){return console.log("Nazwa: ",e.name),console.log("Id:    ",e.id),console.log("Connected: ",e.gatt.connected),e.gatt.connect()})).then((function(e){return console.log("Getting Battery Service..."),e.getPrimaryService("automation_io")})).then((function(e){return console.log("Getting Battery Level Characteristic..."),e.getCharacteristic("battery_level")})).then((function(e){return console.log("Reading Battery Level..."),e.readValue()})).then((function(e){var t=e.getUint8(0);console.log("> Battery Level is "+t+"%")})).catch((function(e){console.warn("Argh!",e)})):console.log("Nie ma API Bluetooth w przegl\u0105darce")}},{key:"hasError",value:function(e){console.error("M\xf3j error",e),this.hasErrorVisible=!0,this.errorMessage=e}},{key:"device",get:function(){return this.bleService.getDevice()}}]),e}(),c.\u0275fac=function(e){return new(e||c)(h.Jb(f.a),h.Jb(y))},c.\u0275cmp=h.Db({type:c,selectors:[["app-locker"]],decls:59,vars:6,consts:[[3,"translucent"],[3,"fullscreen"],["collapse","condense"],["size","large"],[3,"hidden"],["color","danger"],["color","danger","name","close-circle-outline",1,"ion-float-right"],["expand","block",3,"click"]],template:function(e,t){1&e&&(h.Mb(0,"ion-header",0),h.Mb(1,"ion-toolbar"),h.Mb(2,"ion-title"),h.bc(3," Blokada "),h.Lb(),h.Lb(),h.Lb(),h.Mb(4,"ion-content",1),h.Mb(5,"ion-header",2),h.Mb(6,"ion-toolbar"),h.Mb(7,"ion-title",3),h.bc(8,"Blokada"),h.Lb(),h.Lb(),h.Lb(),h.Mb(9,"ion-grid"),h.Mb(10,"ion-row",4),h.Mb(11,"ion-col"),h.Mb(12,"ion-text",5),h.bc(13),h.Lb(),h.Kb(14,"ion-icon",6),h.Lb(),h.Lb(),h.Mb(15,"ion-row"),h.Mb(16,"ion-col"),h.bc(17,"Akumulator"),h.Lb(),h.Mb(18,"ion-col"),h.bc(19),h.Lb(),h.Mb(20,"ion-col"),h.bc(21),h.Lb(),h.Lb(),h.Mb(22,"ion-row"),h.Mb(23,"ion-col"),h.bc(24," Status "),h.Lb(),h.Kb(25,"ion-col"),h.Kb(26,"ion-col"),h.Lb(),h.Mb(27,"ion-row"),h.Mb(28,"ion-col"),h.bc(29," Zaj\u0119to\u015b\u0107 "),h.Lb(),h.Kb(30,"ion-col"),h.Kb(31,"ion-col"),h.Lb(),h.Mb(32,"ion-row"),h.Mb(33,"ion-col"),h.Mb(34,"ion-button",7),h.Tb("click",(function(){return t.runBluetooth()})),h.bc(35,"Notyfikacje"),h.Lb(),h.Lb(),h.Mb(36,"ion-col"),h.Mb(37,"ion-button",7),h.Tb("click",(function(){return t.readBattery()})),h.bc(38,"Czytaj"),h.Lb(),h.Lb(),h.Mb(39,"ion-col"),h.Mb(40,"ion-button",7),h.Tb("click",(function(){return t.disconnectBluetooth()})),h.bc(41,"Roz\u0142\u0105cz"),h.Lb(),h.Lb(),h.Lb(),h.Mb(42,"ion-row"),h.Mb(43,"ion-col"),h.Mb(44,"ion-button",7),h.Tb("click",(function(){return t.connectBluetooth()})),h.bc(45,"Po\u0142\u0105cz"),h.Lb(),h.Lb(),h.Mb(46,"ion-col"),h.Mb(47,"ion-button",7),h.Tb("click",(function(){return t.disconnectBluetooth()})),h.bc(48,"Roz\u0142\u0105cz"),h.Lb(),h.Lb(),h.Lb(),h.Mb(49,"ion-row"),h.Mb(50,"ion-col"),h.Mb(51,"ion-button",7),h.Tb("click",(function(){return t.startRead()})),h.bc(52,"Czytaj"),h.Lb(),h.Lb(),h.Mb(53,"ion-col"),h.Mb(54,"ion-button",7),h.Tb("click",(function(){return t.changeState(!0)})),h.bc(55,"Otw\xf3rz"),h.Lb(),h.Lb(),h.Mb(56,"ion-col"),h.Mb(57,"ion-button",7),h.Tb("click",(function(){return t.changeState(!1)})),h.bc(58,"Zamknij"),h.Lb(),h.Lb(),h.Lb(),h.Lb(),h.Lb()),2&e&&(h.Xb("translucent",!0),h.zb(4),h.Xb("fullscreen",!0),h.zb(6),h.Xb("hidden",!t.hasErrorVisible),h.zb(3),h.cc(t.errorMessage),h.zb(6),h.cc(t.currentValue),h.zb(2),h.cc(t.currentTS))},directives:[a.f,a.p,a.o,a.d,a.e,a.j,a.c,a.n,a.g,a.b],styles:[""]}),c)}],L=((r=function e(){_classCallCheck(this,e)}).\u0275mod=h.Hb({type:r}),r.\u0275inj=h.Gb({factory:function(e){return new(e||r)},imports:[[l.i.forChild(k)],l.i]}),r),M=((o=function e(){_classCallCheck(this,e)}).\u0275mod=h.Hb({type:o}),o.\u0275inj=h.Gb({factory:function(e){return new(e||o)},imports:[[a.q,b.b,s.a,u.a,L]]}),o)}}]);